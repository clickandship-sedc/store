"use strict";(self.webpackChunkdropship_react=self.webpackChunkdropship_react||[]).push([[122],{8122:(e,s,i)=>{i.r(s),i.d(s,{default:()=>z});var l=i(2791),r=i(7689),c=i(1087),d=i(9434),t=i(9661),n=i(4368),a=i(4511),o=i(186),u=i(3239),h=i(5376),v=i(6322),x=i(4893),j=i(7563),p=i(4316),m=i(806),g=i(6983),f=i(3405),b=i(779),y=i(184);const S=e=>{let{color:s,handleColorSelection:i,selectedColor:l}=e;return(0,y.jsx)("li",{children:(0,y.jsxs)("button",{disabled:s===l,onClick:()=>i(s),children:[(0,y.jsxs)("svg",{viewBox:"0 0 150 150",children:[(0,y.jsx)("path",{d:"M121.875 18.75H28.125C25.6386 18.75 23.254 19.7377 21.4959 21.4959C19.7377 23.254 18.75 25.6386 18.75 28.125V121.875C18.75 124.361 19.7377 126.746 21.4959 128.504C23.254 130.262 25.6386 131.25 28.125 131.25H121.875C124.361 131.25 126.746 130.262 128.504 128.504C130.262 126.746 131.25 124.361 131.25 121.875V28.125C131.25 25.6386 130.262 23.254 128.504 21.4959C126.746 19.7377 124.361 18.75 121.875 18.75ZM28.125 121.875V28.125H121.875V121.875H28.125Z",fill:s}),(0,y.jsx)("rect",{x:"40",y:"40",width:"70",height:"70",rx:"5",fill:s})]}),(0,y.jsx)("p",{children:s})]})})},C=e=>{let{uniqueSize:s,currentSize:i,handleSizeSelection:l,selectedSize:r,selectedColor:c}=e;return(0,y.jsx)("li",{children:(0,y.jsx)("button",{disabled:!i||(null===i||void 0===i?void 0:i.size)===r||(null===i||void 0===i?void 0:i.stock)<1||!c,className:(null===i||void 0===i?void 0:i.size)===r?"active":"",onClick:()=>l(null===i||void 0===i?void 0:i.size),children:(0,y.jsx)("p",{children:s})})})},z=function(){var e;const{productId:s}=(0,r.UO)(),i=(0,d.I0)(),z=(0,d.v9)((e=>e.role.authTokens)),N=(0,d.v9)((e=>e.role.userid)),k=(0,d.v9)((e=>e.user.isLoggedIn)),w=(0,d.v9)((e=>e.cart.orderItems)),[M,I]=(0,l.useState)(!1),{data:P}=(0,x.a)({queryKey:["userQuery",N],queryFn:()=>(0,f.PR)(N,z),enabled:!!(null!==z&&void 0!==z&&z.accessToken&&null!==z&&void 0!==z&&z.refreshToken&&(null===N||void 0===N?void 0:N.length)>0)}),{data:E,error:H,isError:q,isPending:L,isSuccess:F,refetch:A}=(0,x.a)({queryKey:["productQuery",s],queryFn:()=>(0,j.ax)(s)}),{data:T,error:V,isError:Z,isPending:B,isSuccess:D,refetch:R}=(0,x.a)({queryKey:["subcategoryQuery",null===E||void 0===E?void 0:E.subcategory.id],queryFn:()=>(0,g.g)(null===E||void 0===E?void 0:E.subcategory.id),enabled:!!E}),[K,O]=(0,l.useState)(!1),[Q,U]=(0,l.useState)(0),[$,_]=(0,l.useState)(!1),[Y,G]=(0,l.useState)(""),[J,W]=(0,l.useState)(""),[X,ee]=(0,l.useState)(null),[se,ie]=(0,l.useState)([]),[le,re]=(0,l.useState)([]),[ce,de]=(0,l.useState)([]),[te,ne]=(0,l.useState)([]),[ae,oe]=(0,l.useState)([]),[ue,he]=(0,l.useState)(1),[ve,xe]=(0,l.useState)(!1);(0,l.useEffect)((()=>{var e,s;ie(null===E||void 0===E||null===(e=E.productSizes)||void 0===e?void 0:e.reduce(((e,s)=>(s.color&&e.push(s.color),e)),[])),re(null===E||void 0===E||null===(s=E.productSizes)||void 0===s?void 0:s.reduce(((e,s)=>(s.size&&e.push(s.size),e)),[]))}),[E]),(0,l.useEffect)((()=>{le&&se&&(de([...new Set(se)]),ne([...new Set(le)]))}),[se,le]),(0,l.useEffect)((()=>{_(!(!k||!E)&&E.ratings.some((e=>e.userId===(null===P||void 0===P?void 0:P.id))))}),[$,E,k,P]),(0,l.useEffect)((()=>{var e;E&&xe(!$&&(null===E||void 0===E||null===(e=E.ratings)||void 0===e?void 0:e.every((e=>""===e.review&&""===e.pros&&""===e.cons))))}),[$,E]),(0,l.useEffect)((()=>{E?1===E.productSizes.length?ee(E.productSizes[0]):Y?1!==te.length&&J?ee(E.productSizes.find((e=>e.color===Y&&e.size===J))):1===te.length&&ee(E.productSizes.find((e=>e.color===Y))):ee(null):ee(null)}),[E,Y,J,te]),(0,l.useEffect)((()=>{oe(Y&&E?E.productSizes.filter((e=>e.color===Y)):[])}),[Y,E]),(0,l.useEffect)((()=>{if(w&&X){const e=w.some((e=>e.id===X.id));I(e)}}),[w,X]);const je=e=>{G(e),W(""),ee(null),he(1)},pe=e=>{W(e),he(1)};return(0,y.jsx)(y.Fragment,{children:L?(0,y.jsx)(p.BigLoadingDiv,{link:"/",title:"loading product...",message:"you can click here to retry if its taking too long",refetch:A}):F&&E?(0,y.jsxs)("main",{className:"product-page",children:[(0,y.jsx)(a.lw,{categoryid:E.category.id,categorytitle:E.category.name,subcategoryid:E.subcategory.id,subcategorytitle:E.subcategory.name}),(0,y.jsxs)("div",{className:"product-details",children:[(0,y.jsx)("div",{className:"product-image",children:(0,y.jsx)(u.Z,{url:E.image,alt:E.name,backupUrl:"/imgs/404/product404.png",backupAlt:"Product Image 404"})}),(0,y.jsxs)("div",{className:"product-info",children:[(0,y.jsxs)("div",{className:"product-header",children:[(0,y.jsxs)("h2",{className:"product-title",children:[(0,y.jsx)("span",{children:E.name}),(0,y.jsxs)(c.OL,{to:"/manufacturer/".concat(E.manufacturer.id),children:[(0,y.jsx)("p",{children:E.manufacturer.name}),(0,y.jsx)(u.Z,{url:E.manufacturer.image,alt:E.manufacturer.name,backupUrl:"/imgs/404/category404.png",backupAlt:"Manufacturer"})]})]}),(0,y.jsxs)("div",{className:"product-rating",children:[$||!k||K?(0,y.jsx)(n.Z,{initialRating:E.rating,id:s}):(0,y.jsx)(n.c,{initialRating:E.rating,id:s,onClick:e=>{U(e),O(!0)}}),(0,y.jsxs)("p",{children:["(",E.ratings.length||0,")"]})]})]}),(0,y.jsxs)("div",{className:"variants",children:[(0,y.jsxs)("div",{className:"description-div",children:[(0,y.jsx)("h3",{children:"Description"}),(0,y.jsx)("p",{className:"product-description",children:E.description})]}),ce.length>1&&(0,y.jsxs)("div",{className:"colors",children:[(0,y.jsx)("h3",{children:"Colours"}),(0,y.jsx)("ul",{children:ce.map(((e,s)=>(0,y.jsx)(S,{color:e,handleColorSelection:je,selectedColor:Y},s)))})]}),(null===te||void 0===te?void 0:te.length)>1&&(0,y.jsxs)("div",{className:"sizes",children:[(0,y.jsx)("h3",{children:"Sizes"}),(0,y.jsx)("ul",{children:null===te||void 0===te?void 0:te.map(((e,s)=>(0,y.jsx)(C,{uniqueSize:e,handleSizeSelection:pe,currentSize:ae.find((s=>s.size===e)),selectedSize:J,selectedColor:Y},s)))})]})]}),(0,y.jsxs)("div",{className:"paymentDiv",children:[(0,y.jsxs)("div",{className:"count",children:[(0,y.jsx)("button",{className:"amount-btn",onClick:()=>{null!==X&&ue>1&&he(ue-1)},disabled:ue<=1||M,children:"-"}),(0,y.jsxs)("p",{className:"product-count",children:["Amount: ",ue]}),(0,y.jsxs)("p",{className:"product-count",children:["Available: ",null!==X?X.stock:"?"]}),(0,y.jsx)("button",{className:"amount-btn",onClick:()=>{null!==X&&ue<X.stock&&he(ue+1)},disabled:null===X||ue>=X.stock||M,children:"+"})]}),(0,y.jsxs)("div",{className:"prices",children:[(0,y.jsxs)("p",{className:"product-price",children:[(0,y.jsx)("span",{children:"Price:"}),(0,y.jsxs)("span",{children:["$",E.price]})]}),E.discountPercentage>1&&(0,y.jsxs)("p",{className:"product-discount",children:[(0,y.jsx)("span",{children:"Discount:"})," ",(0,y.jsxs)("span",{children:[E.discountPercentage,"%"]})]}),(0,y.jsxs)("p",{className:"product-total",children:[(0,y.jsx)("span",{children:"Total:"})," ",(0,y.jsxs)("span",{children:["$",E.discountedPrice*ue]})]})]}),(0,y.jsxs)("button",{disabled:null===X||M,className:"buy-button",onClick:()=>{let e={...X,quantity:ue,name:E.name,price:E.price,total:E.discountedPrice,image:E.image,discount:E.discountPercentage,productId:E.id};i((0,m.uC)(e)),i((0,b.pT)({title:"Product added to cart",success:"You can add different colors and sizes too, and change quantity in the Cart.",error:""})),i((0,b.vb)(!0))},children:[(0,y.jsxs)("svg",{viewBox:"0 0 32 32",children:[(0,y.jsx)("circle",{cx:"10",cy:"28",r:"2",fill:"currentColor"}),(0,y.jsx)("circle",{cx:"24",cy:"28",r:"2",fill:"currentColor"}),(0,y.jsx)("path",{fill:"currentColor",d:"M4.98 2.804A1 1 0 0 0 4 2H0v2h3.18l3.84 19.196A1 1 0 0 0 8 24h18v-2H8.82l-.8-4H26a1 1 0 0 0 .976-.783L29.244 7h-2.047l-1.999 9H7.62Z"}),(0,y.jsx)("path",{fill:"currentColor",d:"M18 6V2h-2v4h-4v2h4v4h2V8h4V6h-4z"})]}),(0,y.jsx)("p",{children:"Add To Cart"})]})]})]})]}),(0,y.jsx)("div",{className:"block-header",children:(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{children:"Customer Reviews"}),(0,y.jsxs)("button",{disabled:K||$||!P||!k,onClick:()=>O(!0),children:[(0,y.jsx)("p",{children:"Review this product"}),(0,y.jsx)("svg",{viewBox:"0 0 32 32",children:(0,y.jsx)("path",{fill:"currentColor",d:"M2 26h28v2H2zM25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z"})})]})]})}),!ve||$&&k||K?(0,y.jsx)("div",{className:"reviews",children:(0,y.jsxs)("ul",{className:"reviews-ul",children:[K&&(0,y.jsx)(o.FM,{shouldEdit:!0,handleCancel:()=>{O(!1)},review:{author:"".concat(null===P||void 0===P?void 0:P.firstName," ").concat(null===P||void 0===P?void 0:P.lastName),date:Date(),title:"",rate:Q,review:"",id:Date.now(),pros:"",cons:""},productId:E.id,userId:null===P||void 0===P?void 0:P.id,new:!0}),null===E||void 0===E||null===(e=E.ratings)||void 0===e?void 0:e.map((e=>e.userId===(null===P||void 0===P?void 0:P.id)&&k&&$?(0,y.jsx)(o.FM,{review:e,userId:null===P||void 0===P?void 0:P.id,productId:E.id,new:!1},e.id):(""!==e.review||""!==e.pros||""!==e.cons)&&(0,y.jsx)(o.ZP,{review:e},e.id)))]})}):(0,y.jsxs)("div",{className:"reviewIllustration",children:[(0,y.jsx)(h.v,{}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{children:"No reviews found."}),(0,y.jsx)("p",{children:"Be The first one to review this product"})]})]}),(0,y.jsx)("div",{className:"block-header",children:(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{children:"Related products"}),(0,y.jsxs)(c.OL,{to:T?"/subcategory/".concat(T.id):"/",children:[(0,y.jsx)("p",{children:"Browse All"}),(0,y.jsx)("svg",{viewBox:"0 0 32 32",children:(0,y.jsx)("path",{fill:"currentColor",d:"m30 28.586l-4.689-4.688a8.028 8.028 0 1 0-1.414 1.414L28.586 30zM19 25a6 6 0 1 1 6-6a6.007 6.007 0 0 1-6 6zM2 12h8v2H2zM2 2h16v2H2zm0 5h16v2H2z"})})]})]})}),(0,y.jsx)("div",{className:"related-products",children:B||Z?(0,y.jsx)(p.LoadingErrorDiv,{isError:Z,classTitle:"relatedProductsMain",errorMessage:null===V||void 0===V?void 0:V.message,refetch:R,loadMessage:"Loading Related Products"}):D&&T?(0,y.jsx)(y.Fragment,{children:T.products.slice(0,4).map((e=>(0,y.jsx)(t.Z,{product:e,subCatImage:T.image},e.id)))}):(0,y.jsx)(y.Fragment,{})})]}):q?(0,y.jsx)(v.default,{link:"/",title:"dont have that one",message:H.message}):(0,y.jsx)(y.Fragment,{})})}},6983:(e,s,i)=>{i.d(s,{g:()=>r});const l="/mock";async function r(e){const s=await fetch("".concat(l,"/subcategory.json"));if(!s.ok)throw new Error("Cannot find subcategory");return s.json()}}}]);
//# sourceMappingURL=122.60714abb.chunk.js.map